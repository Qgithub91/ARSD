rm(list = ls())

pacman::p_load(tidyverse, ggprism)

high.vulnerability <- read.table("High.20250411.node.vul.tsv", sep = "\t", header = T) %>% 
  slice_max(node.vul)
low.vulnerability <- read.table("Low.20250411.node.vul.tsv", sep = "\t", header = T) %>% 
  slice_max(node.vul)

vulnerability <- rbind(high.vulnerability, low.vulnerability)

vulnerability.plot <- ggplot(vulnerability, aes(x = treat, y = node.vul, fill = treat))+
  geom_bar(stat = "identity", position = position_dodge(), width = 0.7)+
  # 确保Y轴从0开始并与X轴相交，expand = expansion(mult = c(0, 0))消除了默认的扩展空间，使得图表的边界紧贴数据的最小值和最大值。
  scale_y_continuous(expand = expansion(mult = c(0, 0)), limits = c(0, 0.016))+
  labs(y = "vulnerability", x = "Area")+
  scale_fill_manual(values = c("#7A1B6D", "#91D540"), guide = "none") +
  theme_bw()+#主题设置
  theme(panel.grid = element_blank(),
        axis.text = element_text(color="black", size = 14),
        axis.title = element_text(color="black", size = 16),
        legend.text = element_text(color="black", size = 14),
        legend.title = element_text(color="black", size = 16))    #设置分面字体)

vulnerability.plot

ggsave(paste0(format(Sys.time(), "%Y%m%d"), ".vulnerability.plot.pdf"), vulnerability.plot, width = 4, height = 4, dpi = 300)
